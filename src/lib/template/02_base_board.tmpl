<% c++ #include "controller/baseboard.h" %>
<% c++ #include "controller/board.h" %>
<% c++ #include "controller/thread.h" %>
<% skin my_skin %>
<% view base_board uses Content::BaseBoard extends base %>

<% template banner() %>
<div class="banner">
    <img src="/<%= sitePathPrefix %>img/banner/<%= bannerFileName %>">
</div>
<% end template %>

<% template navigationButton(std::string target) %>
<% if ( "top" == target ) %>
    <a class="navigationButton navigationButtonBottom" title="<%= toTopText %>"
       href="#top"><img src="/<%= sitePathPrefix %>img/up.png"></a>
<% elif ( "bottom" == target ) %>
    <a class="navigationButton navigationButtonTop" title="<%= toBottomText %>"
       href="#bottom"><img src="/<%= sitePathPrefix %>img/down.png"></a>
<% end %>
<% end template %>

<% template customPostFormField0() %>
<% end template %>

<% template customPostFormField1() %>
<% end template %>

<% template customPostFormField2() %>
<% end template %>

<% template customPostFormField3() %>
<% end template %>

<% template customPostFormField4() %>
<% end template %>

<% template customPostFormField5() %>
<% end template %>

<% template customPostFormField6() %>
<% end template %>

<% template customPostFormField7() %>
<% end template %>

<% template customPostFormField8() %>
<% end template %>

<% template customPostFormFieldEdit0() %>
<% end template %>

<% template customPostFormFieldEdit1() %>
<% end template %>

<% template customPostFormFieldEdit2() %>
<% end template %>

<% template customPostFormFieldEdit3() %>
<% end template %>

<% template customPostFormFieldEdit4() %>
<% end template %>

<% template customPostFormFieldEdit5() %>
<% end template %>

<% template customPostFormFieldEdit6() %>
<% end template %>

<% template customPostBody0(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBody1(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBody2(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBody3(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBody4(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBody5(Content::Post, Content::Board::ThreadPointer) %>
<% end template %>

<% template customPostBodyTemplate0() %>
<% end template %>

<% template customPostBodyTemplate1() %>
<% end template %>

<% template customPostBodyTemplate2() %>
<% end template %>

<% template customPostBodyTemplate3() %>
<% end template %>

<% template customPostBodyTemplate4() %>
<% end template %>

<% template customPostBodyTemplate5() %>
<% end template %>

<% template createAction(std::string position) %>
<div id="createActionContainer<%= position %>" class="createAction">
    <div>
        [<a id="showHidePostFormButton<%= position %>"
            href="javascript:lord.showHidePostForm('<%= position %>');"><%= showPostFormText %></a>]
    </div>
</div>
<% end template %>

<% template postFile(Content::File file, Content::Post post) %>
<td class="postFile">
    <div class="postFileName">
        <a href="/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.sourceName %>"
           target="_blank"><%= file.sourceName %></a>
    </div>
    <div class="postFileSize">
        (<%= file.size %>)
    </div>
    <div class="postFileSearch">
        <a name="deleteFileButton"
           href="javascript:lord.deleteFile('<%= currentBoard.name %>', <%= post.number %>, '<%= file.sourceName %>');">
            <img src="/<%= sitePathPrefix %>img/delete.png" title="<%= deleteFileText %>" /></a>
        <% if ( content.isImageType(file.type) ) %>
            <a href="//www.google.com/searchbyimage?image_url=<%= siteProtocol %>://<%= siteDomain %>/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.sourceName %>"
               title="<%= findSourceWithGoogleText %>" target="_blank">
                <img src="/<%= sitePathPrefix %>img/google.png"></a>
            <a href="http://iqdb.org/?url=<%= siteProtocol %>://<%= siteDomain %>/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.sourceName %>"
               title="<%= findSourceWithIqdbText %>" target="_blank">
                <img src="/<%= sitePathPrefix %>img/iqdb.png"></a>
        <% end %>
    </div>
    <div class="postFileFile">
        <a href="/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.sourceName %>"
           onclick="return lord.showImage('/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.sourceName %>', '<%= file.type %>', <%= file.sizeX %>, <%= file.sizeY %>);">
            <% if ( content.isSpecialThumbName(file.thumbName) ) %>
                <img src="/<%= sitePathPrefix %>img/<%= file.specialThumbName() %>_logo.png"
                     width="<%= file.thumbSizeX %>" height="<%= file.thumbSizeY %>">
            <% else %>
                <% if ( file.thumbSizeX > 0 && file.thumbSizeY > 0 ) %>
                    <img src="/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.thumbName %>"
                         width="<%= file.thumbSizeX %>" height="<%= file.thumbSizeY %>">
                <% else %>
                    <img src="/<%= sitePathPrefix %><%= currentBoard.name %>/<%= file.thumbName %>">
                <% end %>
            <% end %>
        </a>
    </div>
</td>
<% end template %>

<% template post(Content::Post post, Content::Board::ThreadPointer thread) %>
<% if ( post.number == post.threadNumber ) %>
    <% if ( post.hidden ) %>
        <div id="post<%= post.number %>" class="opPost hiddenPost">
    <% else %>
        <div id="post<%= post.number %>" class="opPost">
    <% end %>
<% else %>
    <% if ( post.hidden ) %>
        <div id="post<%= post.number %>" class="post hiddenPost">
    <% else %>
        <div id="post<%= post.number %>" class="post">
    <% end %>
<% end %>
    <div class="postHeader">
        <% if ( !thread ) %>
            <a id="<%= post.number %>"></a>
        <% end %>
        <% if ( post.number == post.threadNumber ) %>
            <% if ( (thread && thread->fixed) || (!thread && dynamic_cast<Content::Thread *>(&content)->fixed) ) %>
                <img src="/<%= sitePathPrefix %>img/fixed.png" title="<%= fixedText %>">
            <% end %>
            <% if ( (thread && thread->closed) || (!thread && dynamic_cast<Content::Thread *>(&content)->closed) ) %>
                <img src="/<%= sitePathPrefix %>img/closed.png" title="<%= closedText %>">
            <% end %>
        <% end %>
        <span class="postSubject">
            <% if ( post.subjectIsRaw ) %>
                <%= post.subject | raw %>
            <% else %>
                <b><%= post.subject %></b>
            <% end %>
        </span>
        <% if ( post.showRegistered && post.showTripcode ) %>
            <img src="/<%= sitePathPrefix %>img/registered.png" title="<%= registeredText %>">
        <% end %>
        <% if ( !post.email.empty() ) %>
            <a href="mailto:<%= post.email %>"><%= post.nameRaw %></a>
        <% else %>
            <%= post.name | raw %>
        <% end %>
        <% if ( !post.tripcode.empty() && post.showTripcode ) %>
            <span class="tripcode"><%= post.tripcode %></span>
        <% end %>
        <% if ( content.showWhois && !post.flagName.empty() ) %>
            <% if ( !post.cityName.empty() ) %>
                <img src="/<%= sitePathPrefix %>img/flag/<%= post.flagName %>"
                     title="<%= post.countryName %>: <%= post.cityName %>">
            <% else %>
                <img src="/<%= sitePathPrefix %>img/flag/<%= post.flagName %>" title="<%= post.countryName %>">
            <% end %>
        <% end %>
        <%= post.dateTime %>
        <% if ( content.postingEnabled ) %>
            <% if ( thread ) %>
                <% if ( content.moder ) %>
                    #<a href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/<%= thread->opPost.number %>.html#i<%= post.number %>"
                        title="<%= post.ip %>"><%= post.number %></a>
                <% else %>
                    #<a href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/<%= thread->opPost.number %>.html#i<%= post.number %>"><%= post.number %></a>
                <% end %>
            <% else %>
                <% if ( content.moder ) %>
                    #<a href="javascript:lord.insertPostNumber(<%= post.number %>);"
                        title="<%= post.ip %>"><%= post.number %></a>
                <% else %>
                    #<a href="javascript:lord.insertPostNumber(<%= post.number %>);"><%= post.number %></a>
                <% end %>
            <% end %>
        <% else %>
            <% if ( thread ) %>
                <% if ( content.moder ) %>
                    #<a href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/<%= thread->opPost.number %>.html#<%= post.number %>"
                        title="<%= post.ip %>"><%= post.number %></a>
                <% else %>
                    #<a href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/<%= thread->opPost.number %>.html#<%= post.number %>"><%= post.number %></a>
                <% end %>
            <% else %>
                <% if ( content.moder ) %>
                    #<a href="#<%= post.number %>" title="<%= post.ip %>"><%= post.number %></a>
                <% else %>
                    #<a href="#<%= post.number %>"><%= post.number %></a>
                <% end %>
            <% end %>
        <% end %>
        [<a href="javascript:lord.quickReply(<%= post.number %>);" title="<%= quickReplyText %>">&gt;&gt;</a>]
        <% if ( content.moder || post.draft ) %>
            <a name="editButton" href="javascript:lord.editPost('<%= currentBoard.name %>', '<%= post.number %>');">
                <img src="/<%= sitePathPrefix %>img/edit.png" title="<%= editPostText %>" /></a>
        <% end %>
        <% if ( content.moder && post.number == post.threadNumber ) %>
            <% if ( (thread && thread->fixed) || (!thread && dynamic_cast<Content::Thread *>(&content)->fixed) ) %>
                <a name="fixButton"
                   href="javascript:lord.setThreadFixed('<%= currentBoard.name %>', '<%= post.number %>', false);">
                    <img src="/<%= sitePathPrefix %>img/unfix.png" title="<%= unfixThreadText %>" /></a>
            <% else %>
                <a name="fixButton"
                   href="javascript:lord.setThreadFixed('<%= currentBoard.name %>', '<%= post.number %>', true);">
                    <img src="/<%= sitePathPrefix %>img/fixed.png" title="<%= fixThreadText %>" /></a>
            <% end %>
            <% if ( (thread && thread->closed) || (!thread && dynamic_cast<Content::Thread *>(&content)->closed) ) %>
                <a name="closeButton"
                   href="javascript:lord.setThreadOpened('<%= currentBoard.name %>', '<%= post.number %>', true);">
                    <img src="/<%= sitePathPrefix %>img/open.png" title="<%= openThreadText %>" /></a>
            <% else %>
                <a name="closeButton"
                   href="javascript:lord.setThreadOpened('<%= currentBoard.name %>', '<%= post.number %>', false);">
                    <img src="/<%= sitePathPrefix %>img/closed.png" title="<%= closeThreadText %>" /></a>
            <% end %>
        <% end %>
        <% if ( content.moder ) %>
            <a name="banButton" href="javascript:lord.banUser('<%= currentBoard.name %>', '<%= post.number %>');">
                <img src="/<%= sitePathPrefix %>img/ban.png" title="<%= banUserText %>" /></a>
        <% end %>
        <% if ( !thread && post.number == post.threadNumber ) %>
            <a name="downloadButton" href="javascript:lord.downloadThread();">
                <img src="/<%= sitePathPrefix %>img/download.png" title="<%= downloadThreadText %>" /></a>
        <% end %>
        <a name="complainButton" href="javascript:lord.complain();">
            <img src="/<%= sitePathPrefix %>img/complain.png" title="<%= complainText %>" /></a>
        <a name="deleteButton"
           href="javascript:lord.deletePost('<%= currentBoard.name %>', '<%= post.number %>', true);">
        <% if ( post.number == post.threadNumber ) %>
            <img src="/<%= sitePathPrefix %>img/delete.png" title="<%= deleteThreadText %>" /></a>
        <% else %>
            <img src="/<%= sitePathPrefix %>img/delete.png" title="<%= deletePostText %>" /></a>
        <% end %>
        <% if ( post.number == post.threadNumber ) %>
            <% if ( (thread && thread->hidden) || (!thread && dynamic_cast<Content::Thread *>(&content)->hidden) ) %>
                <a name="hideButton" id="hidePost<%= post.number %>"
                   href="javascript:lord.setThreadHidden('<%= currentBoard.name %>', '<%= post.number %>', false);">
                    <img src="/<%= sitePathPrefix %>img/hide.png" title="<%= showHidePostText %>" /></a>
            <% else %>
                <a name="hideButton" id="hidePost<%= post.number %>"
                   href="javascript:lord.setThreadHidden('<%= currentBoard.name %>', '<%= post.number %>', true);">
                    <img src="/<%= sitePathPrefix %>img/hide.png" title="<%= showHidePostText %>" /></a>
            <% end %>
        <% else %>
            <% if ( post.hidden ) %>
                <a name="hideButton" id="hidePost<%= post.number %>"
                   href="javascript:lord.setPostHidden('<%= currentBoard.name %>', '<%= post.number %>', false);">
                    <img src="/<%= sitePathPrefix %>img/hide.png" title="<%= showHidePostText %>" /></a>
            <% else %>
                <a name="hideButton" id="hidePost<%= post.number %>"
                   href="javascript:lord.setPostHidden('<%= currentBoard.name %>', '<%= post.number %>', true);">
                    <img src="/<%= sitePathPrefix %>img/hide.png" title="<%= showHidePostText %>" /></a>
            <% end %>
        <% end %>
        <% if ( thread && post.number == post.threadNumber ) %>
            [<a href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/<%= post.number %>.html"><%= toThread %></a>]
            <% if ( thread->postLimitReached() ) %>
                <span name="postLimit" class="postLimitReached"><%= postLimitReachedText %></span>
            <% elif ( thread->bumpLimitReached() ) %>
                <span name="bumpLimit" class="bumpLimitReached"><%= bumpLimitReachedText %></span>
            <% end %>
        <% end %>
    </div>
    <table class="threadPost">
        <tbody>
            <% include customPostBody0(post, thread) %>
            <tr>
                <%foreach file in post.files %>
                    <% item %>
                        <% include postFile(file, post) %>
                    <% end %>
                <% end %>
                <input name="rawText" type="hidden" value="<%= post.rawPostText %>" />
                <% if ( post.rawHtml ) %>
                    <input name="rawHtml" type="hidden" value="true" />
                <% else %>
                    <input name="rawHtml" type="hidden" value="false" />
                <% end %>
                <input name="email" type="hidden" value="<%= post.email %>" />
                <input name="name" type="hidden" value="<%= post.rawName %>" />
                <input name="subject" type="hidden" value="<%= post.rawSubject %>" />
                <% if ( post.draft ) %>
                    <input name="draft" type="hidden" value="true" />
                <% else %>
                    <input name="draft" type="hidden" value="false" />
                <% end %>
                <% if ( post.files.size() < 2 ) %>
                    <td class="postText">
                        <% if ( !thread ) %>
                             <blockquote id="post<%= post.number %>Text"
                                         class="blockquoteThread"><%= post.text | raw %></blockquote>
                        <% else %>
                            <blockquote id="post<%= post.number %>Text"><%= post.text | raw %></blockquote>
                        <% end %>

                    </td>
                <% else %>
                    <td class="shrink"></td>
                <% end %>
            </tr>
            <% include customPostBody1(post, thread) %>
            <% if ( post.files.size() >= 2 ) %>
                <tr>
                    <% c++ out() << "<td colspan=\"" << (post.files.size() + 2) << "\" class=\"postText\">"; %>
                        <% if ( !thread ) %>
                            <blockquote id="post<%= post.number %>Text"
                                        class="blockquoteThread"><%= post.text | raw %></blockquote>
                        <% else %>
                            <blockquote id="post<%= post.number %>Text"><%= post.text | raw %></blockquote>
                        <% end %>
                    </td>
                </tr>
            <% end %>
            <% include customPostBody2(post, thread) %>
            <% if ( !post.modificationDateTime.empty() ) %>
                <tr>
                    <% c++ out() << "<td colspan=\"" << (post.files.size() + 2) << "\">"; %>
                        <span class="modificationDateTime"><%= modificationDateTimeText %>
                            <%= post.modificationDateTime %></span>
                    </td>
                </tr>
            <% end %>
            <% include customPostBody3(post, thread) %>
            <% if ( post.bannedFor ) %>
                <tr>
                    <% c++ out() << "<td colspan=\"" << (post.files.size() + 2) << "\">"; %>
                        <span class="bannedFor"><%= bannedForText %></span>
                    <td>
                </tr>
            <% end %>
            <% include customPostBody4(post, thread) %>
            <% if ( !post.referencedBy.empty() ) %>
                <tr name="referencedByTr">
            <% else %>
                <tr name="referencedByTr" style="display: none;">
            <% end %>
                <% c++ out() << "<td colspan=\"" << (post.files.size() + 2) << "\">"; %>
                    <span name="referencedBy" class="referencedBy">
                        <%= referencedByText %>
                        <%foreach ref in post.referencedBy %>
                            <% item %>
                                <% if ( ref.boardName != content.currentBoard.name ) %>
                                    <a href="/<%= sitePathPrefix %><%= ref.boardName %>/thread/<%= ref.threadNumber %>.html#<%= ref.postNumber %>"
                                       onmouseover="lord.viewPost(this, '<%= ref.boardName %>', <%= ref.postNumber %>);"
                                       onmouseout="lord.noViewPost();">&gt;&gt;/<%= ref.boardName %>/<%= ref.postNumber %></a>
                                <% else %>
                                    <a href="/<%= sitePathPrefix %><%= ref.boardName %>/thread/<%= ref.threadNumber %>.html#<%= ref.postNumber %>"
                                       onmouseover="lord.viewPost(this, '<%= ref.boardName %>', <%= ref.postNumber %>);"
                                       onmouseout="lord.noViewPost();">&gt;&gt;<%= ref.postNumber %></a>
                                <% end %>
                            <% end %>
                        <% end %>
                    </span>
                <td>
            </tr>
            <% include customPostBody5(post, thread) %>
        </tbody>
    </table>
</div>
<% end template %>

<% template boardTexts() %>
<% if ( content.moder ) %>
    <input type="hidden" id="moder" value="true" />
<% else %>
    <input type="hidden" id="moder" value="false" />
<% end %>
<% if ( content.postingEnabled ) %>
    <input type="hidden" id="postingEnabled" value="true" />
<% else %>
    <input type="hidden" id="postingEnabled" value="false" />
<% end %>
<input type="hidden" id="maxFileCount" value="<%= maxFileCount %>" />
<input type="hidden" id="currentBoardName" value="<%= currentBoard.name %>" />
<input type="hidden" id="currentBoardTitle" value="<%= currentBoard.title %>" />
<input type="hidden" id="editPostText" value="<%= editPostText %>" />
<input type="hidden" id="showHidePostText" value="<%= showHidePostText %>" />
<input type="hidden" id="banUserText" value="<%= banUserText %>" />
<input type="hidden" id="deleteFileText" value="<%= deleteFileText %>" />
<input type="hidden" id="boardLabelText" value="<%= boardLabelText %>" />
<input type="hidden" id="banLevelLabelText" value="<%= banLevelLabelText %>" />
<input type="hidden" id="banReasonLabelText" value="<%= banReasonLabelText %>" />
<input type="hidden" id="banExpiresLabelText" value="<%= banExpiresLabelText %>" />
<input type="hidden" id="enterPasswordText" value="<%= enterPasswordText %>" />
<input type="hidden" id="enterPasswordTitle" value="<%= enterPasswordTitle %>" />
<input type="hidden" id="ajaxErrorText" value="<%= ajaxErrorText %>" />
<input type="hidden" id="notLoggedInText" value="<%= notLoggedInText %>" />
<input type="hidden" id="complainMessage" value="<%= complainMessage %>" />
<input type="hidden" id="bytesText" value="<%= bytesText %>" />
<input type="hidden" id="kilobytesText" value="<%= kilobytesText %>" />
<input type="hidden" id="megabytesText" value="<%= megabytesText %>" />
<input type="hidden" id="findSourceWithGoogleText" value="<%= findSourceWithGoogleText %>" />
<input type="hidden" id="findSourceWithIqdbText" value="<%= findSourceWithIqdbText %>" />
<input type="hidden" id="hidePostFormText" value="<%= hidePostFormText %>" />
<input type="hidden" id="showPostFormText" value="<%= showPostFormText %>" />
<input type="hidden" id="noCaptchaText" value="<%= noCaptchaText %>" />
<input type="hidden" id="captchaQuotaText" value="<%= captchaQuotaText %>" />
<select id="availableBoardsSelect" class="select" style="display: none;">
    <%foreach board in availableBoards %>
        <% item %>
            <% if ( board.name == content.currentBoard.name ) %>
                <option value="<%= board.name %>" selected="true">[<%= board.name %>] <%= board.title %></option>
            <% else %>
                <option value="<%= board.name %>">[<%= board.name %>] <%= board.title %></option>
            <% end %>
        <% end %>
    <% end %>
</select>
<select id="banLevelsSelect" class="select" style="display: none;">
    <%foreach level in banLevels %>
        <% item %>
            <% if ( 1 == level.level ) %>
                <option value="<%= level.level %>" selected="true"><%= level.description %></option>
            <% else %>
                <option value="<%= level.level %>"><%= level.description %></option>
            <% end %>
        <% end %>
    <% end %>
</select>
<div id="postTemplate" class="post" style="display: none;">
    <div class="postHeader">
        <img name="fixed" src="/<%= sitePathPrefix %>img/fixed.png" title="<%= fixedText %>" style="display: none;">
        <img name="closed" src="/<%= sitePathPrefix %>img/closed.png" title="<%= closedText %>" style="display: none;">
        <b name="subject"></b>
        <img name="registered" src="/<%= sitePathPrefix %>img/registered.png" title="<%= registeredText %>"
             style="display: none;">
        <span name="name"></span>
        <span name="tripcode" class="tripcode" style="display: none;"></span>
        <img name="whois" src="/<%= sitePathPrefix %>img/flag/%flagName%" style="display: none;">
        <span name="dateTime"></span>
        #<a name="number"></a>
        <span name="permanent" style="display: none;">
            [<a name="quickReply" href="javascript:lord.quickReply(%postNumber%);"
                title="<%= quickReplyText %>">&gt;&gt;</a>]
            <a name="editButton" href="javascript:lord.editPost('<%= currentBoard.name %>', '%postNumber%');">
                <img src="/<%= sitePathPrefix %>img/edit.png" title="<%= editPostText %>" /></a>
            <a name="fixButton"
               href="javascript:lord.setThreadFixed('<%= currentBoard.name %>', '%postNumber%', true);">
                <img src="/<%= sitePathPrefix %>img/fixed.png" title="<%= fixThreadText %>" /></a>
            <a name="unfixButton"
               href="javascript:lord.setThreadFixed('<%= currentBoard.name %>', '%postNumber%', false);">
                <img src="/<%= sitePathPrefix %>img/unfix.png" title="<%= unfixThreadText %>" /></a>
            <a name="closeButton"
               href="javascript:lord.setThreadOpened('<%= currentBoard.name %>', '%postNumber%', false);">
                <img src="/<%= sitePathPrefix %>img/closed.png" title="<%= closeThreadText %>" /></a>
            <a name="openButton"
               href="javascript:lord.setThreadOpened('<%= currentBoard.name %>', '%postNumber%', true);">
                <img src="/<%= sitePathPrefix %>img/open.png" title="<%= openThreadText %>" /></a>
            <a name="banButton" href="javascript:lord.banUser('<%= currentBoard.name %>', '%postNumber%');">
                <img src="/<%= sitePathPrefix %>img/ban.png" title="<%= banUserText %>" /></a>
            <input name="rawText" type="hidden" value="" />
            <input name="rawHtml" type="hidden" value="false" />
            <input name="email" type="hidden" value="" />
            <input name="name" type="hidden" value="" />
            <input name="subject" type="hidden" value="" />
            <input name="draft" type="hidden" value="false" />
            <a name="downloadButton" href="javascript:lord.downloadThread();">
                <img src="/<%= sitePathPrefix %>img/download.png" title="<%= downloadThreadText %>" /></a>
            <a href="javascript:lord.complain();">
                <img src="/<%= sitePathPrefix %>img/complain.png" title="<%= complainText %>" /></a>
            <a name="deleteButton"
               href="javascript:lord.deletePost('<%= currentBoard.name %>', '%postNumber%', true);">
                <img src="/<%= sitePathPrefix %>img/delete.png" title="<%= deletePostText %>" /></a>
            <a id="hidePost%postNumber%" name="hideButton"
               href="javascript:lord.setPostHidden('<%= currentBoard.name %>', '%postNumber%', %hide%);">
                <img src="/<%= sitePathPrefix %>img/hide.png" title="<%= showHidePostText %>" /></a>
            <span name="toThread" style="display: none;">
                [<a name="toThreadLink"
                    href="/<%= sitePathPrefix %><%= currentBoard.name %>/thread/%postNumber%.html"><%= toThread %></a>]
            </span>
        </span>
    </div>
    <table class="threadPost">
        <tbody>
            <% include customPostBodyTemplate0() %>
            <tr name="files">
                <td name="oneFileTd" class="postText">
                    <blockquote name="textOneFile"></blockquote>
                </td>
            </tr>
            <% include customPostBodyTemplate1() %>
            <tr name="manyFilesTr">
                <td name="manyFilesTd" class="postText">
                    <blockquote name="textManyFiles"></blockquote>
                </td>
            <tr>
            <% include customPostBodyTemplate2() %>
            <tr>
                <td name="modificationDateTimeTd" colspan="2">
                    <span name="modificationDateTime" class="modificationDateTime"
                          style="display: none;"><%= modificationDateTimeText %></span>
                <td>
            </tr>
            <% include customPostBodyTemplate3() %>
            <tr>
                <td name="bannedForTd" colspan="2">
                    <span name="bannedFor" class="bannedFor" style="display: none;"><%= bannedForText %></span>
                <td>
            </tr>
            <% include customPostBodyTemplate4() %>
            <tr name="referencedByTr" style="display: none;">
                <td name="referencedByTd" colspan="2">
                    <span name="referencedBy" class="referencedBy"><%= referencedByText %></span>
                <td>
            </tr>
            <% include customPostBodyTemplate5() %>
        </tbody>
    </table>
</div>
<table id="editPostTemplate" class="postFormTable" style="display: none;">
    <tbody>
        <% include customPostFormFieldEdit0() %>
        <tr>
            <td class="postformLabel">
                <b><%= postFormLabelEmail %></b>
            </td>
            <td class="postformField">
                <input type="text" maxlength="<%= maxEmailLength %>" name="email" size="43" />
            </td>
        </tr>
        <% include customPostFormFieldEdit1() %>
        <tr>
            <td class="postformLabel">
                <b><%= postFormLabelName %></b>
            </td>
            <td class="postformField">
                <input type="text" maxlength="<%= maxNameLength %>" name="name" size="43" />
            </td>
        </tr>
        <% include customPostFormFieldEdit2() %>
        <tr>
            <td class="postformLabel">
                <b><%= postFormLabelSubject %></b>
            </td>
            <td class="postformField">
                <input type="text" maxlength="<%= maxSubjectLength %>" name="subject" size="43" />
            </td>
        </tr>
        <% include customPostFormFieldEdit3() %>
        <tr>
            <td class="postformLabel">
                <b><%= postFormLabelText %></b>
            </td>
            <td class="postformField">
                <textarea name="text" rows="10" cols="43" placeholder="<%= postFormTextPlaceholder %>"
                          class="postFormTextarea"></textarea>
            </td>
        </tr>
        <% include customPostFormFieldEdit4() %>
        <% if ( content.moder >= 10 ) %>
            <tr>
                <td class="postformLabel">
                    <b><%= postFormLabelRaw %></b>
                </td>
                <td class="postformField">
                    <input type="checkbox" name="raw" value="true" />
                </td>
            </tr>
        <% end %>
        <% if ( content.draftsEnabled && content.loggedIn ) %>
            <tr>
                <td class="postformLabel">
                    <b><%= postFormLabelDraft %></b>
                </td>
                <td class="postformField">
                    <input type="checkbox" name="draft" value="true" />
                </td>
            </tr>
        <% end %>
        <% include customPostFormFieldEdit5() %>
        <tr>
            <td class="postformLabel">
                <b><%= postFormLabelPassword %></b>
            </td>
            <td class="postformField">
                <input type="password" maxlength="<%= maxPasswordLength %>" name="password" size="43" />
             </td>
         </tr>
         <% include customPostFormFieldEdit6() %>
    </tbody>
</table>
<% if ( content.captchaEnabled ) %>
    <div id="hiddenCaptcha" style="display: none;">
        <% if ( content.captchaQuota > 0 ) %>
            <%= captchaWidgetHtml | raw %>
        <% end %>
    </div>
<% end %>
<div id="hiddenPostForm" style="display: none;">
    <form id="postForm" class="postFormInvisible" method="post" accept-charset="utf-8"
          action="/<%= sitePathPrefix %>action/<%= action %>" enctype="multipart/form-data"
          target="kostyleeque" onsubmit="lord.submitted(this);">
        <input type="hidden" value="<%= currentBoard.name %>" name="board" />
        <% if ( content.currentThread > 0 ) %>
            <input type="hidden" value="<%= currentThread %>" name="thread" />
        <% end %>
        <input type="hidden" value="<%= currentCaptchaEngine.id %>" name="captchaEngine" />
        <input type="hidden" value="" name="fileHashes" />
        <table class="postFormTable">
            <tbody>
                <% include customPostFormField0() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelEmail %></b>
                    </td>
                    <td class="postformField">
                        <input type="text" maxlength="<%= maxEmailLength %>" name="email" size="30" />
                        <input type="submit" name="submit" value="<%= postFormButtonSubmit %>" />
                    </td>
                </tr>
                <% include customPostFormField1() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelName %></b>
                    </td>
                    <td class="postformField">
                        <input type="text" maxlength="<%= maxNameLength %>" name="name" size="43" />
                    </td>
                </tr>
                <% include customPostFormField2() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelSubject %></b>
                    </td>
                    <td class="postformField">
                        <input type="text" maxlength="<%= maxSubjectLength %>" name="subject" size="43" />
                    </td>
                </tr>
                <% include customPostFormField3() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelText %></b>
                    </td>
                    <td class="postformField">
                        <textarea name="text" rows="10" cols="43" placeholder="<%= postFormTextPlaceholder %>"
                                  class="postFormTextarea"></textarea>
                    </td>
                </tr>
                <% include customPostFormField4() %>
                <% if ( content.moder >= 10 ) %>
                    <tr>
                        <td class="postformLabel">
                            <b><%= postFormLabelRaw %></b>
                        </td>
                        <td class="postformField">
                            <input type="checkbox" name="raw" value="true" />
                        </td>
                    </tr>
                <% end %>
                <% if ( content.draftsEnabled && content.loggedIn ) %>
                    <tr>
                        <td class="postformLabel">
                            <b><%= postFormLabelDraft %></b>
                        </td>
                        <td class="postformField">
                            <input type="checkbox" name="draft" value="true" />
                        </td>
                    </tr>
                <% end %>
                <% include customPostFormField5() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormInputFile %></b>
                    </td>
                    <td class="postformField">
                        <div class="postformFile" onclick="lord.browseFile(event, this);" title="<%= selectFileText %>">
                            <img class="postformFilePreview" src="/<%= sitePathPrefix %>img/addfile.png">
                            <input type="file" name="file" onchange="lord.fileSelected(this);"
                                   class="postformFileInput" accept="<%= supportedFileTypes %>" />
                            <span class="postformFileText"></span>
                            <a href="javascript:void(0);" style="display: none;" onclick="lord.removeFile(this);"
                               class="postformFileRemoveButton">
                                <img src="/<%= sitePathPrefix %>img/delete.png" title="<%= removeFileText %>"
                                     class="postformFileRemoveImage"></a>
                        </div>
                    </td>
                </tr>
                <% include customPostFormField6() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelPassword %></b>
                    </td>
                    <td class="postformField">
                        <input type="password" maxlength="<%= maxPasswordLength %>" name="password" size="43" />
                    </td>
                </tr>
                <% include customPostFormField7() %>
                <tr>
                    <td class="postformLabel">
                        <b><%= postFormLabelCaptcha %></b>
                    </td>
                    <td id="captchaContainer" class="postformField">
                        <% if ( content.captchaEnabled ) %>
                            <% if ( content.captchaQuota > 0 ) %>
                                <span class="noCaptchaText"><%= noCaptchaText %>. <%= captchaQuotaText %>
                                    <%= captchaQuota %></span>
                            <% else %>
                                <%= captchaWidgetHtml | raw %>
                            <% end %>
                        <% else %>
                            <span class="noCaptchaText"><%= noCaptchaText %></span>
                        <% end %>
                    </td>
                </tr>
                <% include customPostFormField8() %>
                <tr>
                    <td colspan="2" class="postformRules">
                        <ul>
                            <%foreach rule in postformRules %>
                                <% item %>
                                    <li><%= rule | raw %></li>
                                <% end %>
                            <% end %>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
    </form>
</div>
<% end template %>

<% template boardHead() %>
<script type="text/javascript" src="/<%= sitePathPrefix %>js/base_board.js"></script>
<script type="text/javascript" src="/<%= sitePathPrefix %>js/3rdparty/lib-typedarrays-min.js"></script>
<% if ( content.captchaEnabled ) %>
    <% if ( !content.captchaScriptSource.empty() ) %>
        <script type="text/javascript" src="<%= captchaScriptSource %>"></script>
    <% end %>
    <% if ( !content.captchaHeaderHtml.empty() ) %>
        <%= captchaHeaderHtml | raw %>
    <% end %>
<% end %>
<% end template %>

<% end view %>
<% end skin %>
